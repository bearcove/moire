(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();var G,m,Ce,$,de,xe,Le,Se,re,ee,ne,B={},Te=[],Ie=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,J=Array.isArray;function S(n,t){for(var s in t)n[s]=t[s];return n}function ce(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function Ue(n,t,s){var c,i,r,l={};for(r in t)r=="key"?c=t[r]:r=="ref"?i=t[r]:l[r]=t[r];if(arguments.length>2&&(l.children=arguments.length>3?G.call(arguments,2):s),typeof n=="function"&&n.defaultProps!=null)for(r in n.defaultProps)l[r]===void 0&&(l[r]=n.defaultProps[r]);return z(n,l,c,i,null)}function z(n,t,s,c,i){var r={type:n,props:t,key:s,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Ce,__i:-1,__u:0};return i==null&&m.vnode!=null&&m.vnode(r),r}function A(n){return n.children}function X(n,t){this.props=n,this.context=t}function E(n,t){if(t==null)return n.__?E(n.__,n.__i+1):null;for(var s;t<n.__k.length;t++)if((s=n.__k[t])!=null&&s.__e!=null)return s.__e;return typeof n.type=="function"?E(n):null}function Pe(n){var t,s;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,t=0;t<n.__k.length;t++)if((s=n.__k[t])!=null&&s.__e!=null){n.__e=n.__c.base=s.__e;break}return Pe(n)}}function _e(n){(!n.__d&&(n.__d=!0)&&$.push(n)&&!K.__r++||de!=m.debounceRendering)&&((de=m.debounceRendering)||xe)(K)}function K(){for(var n,t,s,c,i,r,l,d=1;$.length;)$.length>d&&$.sort(Le),n=$.shift(),d=$.length,n.__d&&(s=void 0,c=void 0,i=(c=(t=n).__v).__e,r=[],l=[],t.__P&&((s=S({},c)).__v=c.__v+1,m.vnode&&m.vnode(s),ie(t.__P,s,c,t.__n,t.__P.namespaceURI,32&c.__u?[i]:null,r,i??E(c),!!(32&c.__u),l),s.__v=c.__v,s.__.__k[s.__i]=s,Fe(r,s,l),c.__e=c.__=null,s.__e!=i&&Pe(s)));K.__r=0}function $e(n,t,s,c,i,r,l,d,o,_,p){var a,u,h,k,f,w,g,v=c&&c.__k||Te,T=t.length;for(o=Oe(s,t,v,o,T),a=0;a<T;a++)(h=s.__k[a])!=null&&(u=h.__i==-1?B:v[h.__i]||B,h.__i=a,w=ie(n,h,u,i,r,l,d,o,_,p),k=h.__e,h.ref&&u.ref!=h.ref&&(u.ref&&le(u.ref,null,h),p.push(h.ref,h.__c||k,h)),f==null&&k!=null&&(f=k),(g=!!(4&h.__u))||u.__k===h.__k?o=Ne(h,o,n,g):typeof h.type=="function"&&w!==void 0?o=w:k&&(o=k.nextSibling),h.__u&=-7);return s.__e=f,o}function Oe(n,t,s,c,i){var r,l,d,o,_,p=s.length,a=p,u=0;for(n.__k=new Array(i),r=0;r<i;r++)(l=t[r])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=n.__k[r]=z(null,l,null,null,null):J(l)?l=n.__k[r]=z(A,{children:l},null,null,null):l.constructor===void 0&&l.__b>0?l=n.__k[r]=z(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):n.__k[r]=l,o=r+u,l.__=n,l.__b=n.__b+1,d=null,(_=l.__i=We(l,s,o,a))!=-1&&(a--,(d=s[_])&&(d.__u|=2)),d==null||d.__v==null?(_==-1&&(i>p?u--:i<p&&u++),typeof l.type!="function"&&(l.__u|=4)):_!=o&&(_==o-1?u--:_==o+1?u++:(_>o?u--:u++,l.__u|=4))):n.__k[r]=null;if(a)for(r=0;r<p;r++)(d=s[r])!=null&&(2&d.__u)==0&&(d.__e==c&&(c=E(d)),Ee(d,d));return c}function Ne(n,t,s,c){var i,r;if(typeof n.type=="function"){for(i=n.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=n,t=Ne(i[r],t,s,c));return t}n.__e!=t&&(c&&(t&&n.type&&!t.parentNode&&(t=E(n)),s.insertBefore(n.__e,t||null)),t=n.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function We(n,t,s,c){var i,r,l,d=n.key,o=n.type,_=t[s],p=_!=null&&(2&_.__u)==0;if(_===null&&d==null||p&&d==_.key&&o==_.type)return s;if(c>(p?1:0)){for(i=s-1,r=s+1;i>=0||r<t.length;)if((_=t[l=i>=0?i--:r++])!=null&&(2&_.__u)==0&&d==_.key&&o==_.type)return l}return-1}function he(n,t,s){t[0]=="-"?n.setProperty(t,s??""):n[t]=s==null?"":typeof s!="number"||Ie.test(t)?s:s+"px"}function V(n,t,s,c,i){var r,l;e:if(t=="style")if(typeof s=="string")n.style.cssText=s;else{if(typeof c=="string"&&(n.style.cssText=c=""),c)for(t in c)s&&t in s||he(n.style,t,"");if(s)for(t in s)c&&s[t]==c[t]||he(n.style,t,s[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Se,"$1")),l=t.toLowerCase(),t=l in n||t=="onFocusOut"||t=="onFocusIn"?l.slice(2):t.slice(2),n.l||(n.l={}),n.l[t+r]=s,s?c?s.u=c.u:(s.u=re,n.addEventListener(t,r?ne:ee,r)):n.removeEventListener(t,r?ne:ee,r);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in n)try{n[t]=s??"";break e}catch{}typeof s=="function"||(s==null||s===!1&&t[4]!="-"?n.removeAttribute(t):n.setAttribute(t,t=="popover"&&s==1?"":s))}}function ue(n){return function(t){if(this.l){var s=this.l[t.type+n];if(t.t==null)t.t=re++;else if(t.t<s.u)return;return s(m.event?m.event(t):t)}}}function ie(n,t,s,c,i,r,l,d,o,_){var p,a,u,h,k,f,w,g,v,T,P,O,q,ae,W,R,Q,x=t.type;if(t.constructor!==void 0)return null;128&s.__u&&(o=!!(32&s.__u),r=[d=t.__e=s.__e]),(p=m.__b)&&p(t);e:if(typeof x=="function")try{if(g=t.props,v="prototype"in x&&x.prototype.render,T=(p=x.contextType)&&c[p.__c],P=p?T?T.props.value:p.__:c,s.__c?w=(a=t.__c=s.__c).__=a.__E:(v?t.__c=a=new x(g,P):(t.__c=a=new X(g,P),a.constructor=x,a.render=ze),T&&T.sub(a),a.state||(a.state={}),a.__n=c,u=a.__d=!0,a.__h=[],a._sb=[]),v&&a.__s==null&&(a.__s=a.state),v&&x.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=S({},a.__s)),S(a.__s,x.getDerivedStateFromProps(g,a.__s))),h=a.props,k=a.state,a.__v=t,u)v&&x.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),v&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(v&&x.getDerivedStateFromProps==null&&g!==h&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(g,P),t.__v==s.__v||!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(g,a.__s,P)===!1){for(t.__v!=s.__v&&(a.props=g,a.state=a.__s,a.__d=!1),t.__e=s.__e,t.__k=s.__k,t.__k.some(function(F){F&&(F.__=t)}),O=0;O<a._sb.length;O++)a.__h.push(a._sb[O]);a._sb=[],a.__h.length&&l.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(g,a.__s,P),v&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(h,k,f)})}if(a.context=P,a.props=g,a.__P=n,a.__e=!1,q=m.__r,ae=0,v){for(a.state=a.__s,a.__d=!1,q&&q(t),p=a.render(a.props,a.state,a.context),W=0;W<a._sb.length;W++)a.__h.push(a._sb[W]);a._sb=[]}else do a.__d=!1,q&&q(t),p=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++ae<25);a.state=a.__s,a.getChildContext!=null&&(c=S(S({},c),a.getChildContext())),v&&!u&&a.getSnapshotBeforeUpdate!=null&&(f=a.getSnapshotBeforeUpdate(h,k)),R=p,p!=null&&p.type===A&&p.key==null&&(R=He(p.props.children)),d=$e(n,J(R)?R:[R],t,s,c,i,r,l,d,o,_),a.base=t.__e,t.__u&=-161,a.__h.length&&l.push(a),w&&(a.__E=a.__=null)}catch(F){if(t.__v=null,o||r!=null)if(F.then){for(t.__u|=o?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;r[r.indexOf(d)]=null,t.__e=d}else{for(Q=r.length;Q--;)ce(r[Q]);te(t)}else t.__e=s.__e,t.__k=s.__k,F.then||te(t);m.__e(F,t,s)}else r==null&&t.__v==s.__v?(t.__k=s.__k,t.__e=s.__e):d=t.__e=Ve(s.__e,t,s,c,i,r,l,o,_);return(p=m.diffed)&&p(t),128&t.__u?void 0:d}function te(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(te)}function Fe(n,t,s){for(var c=0;c<s.length;c++)le(s[c],s[++c],s[++c]);m.__c&&m.__c(t,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(r){r.call(i)})}catch(r){m.__e(r,i.__v)}})}function He(n){return typeof n!="object"||n==null||n.__b&&n.__b>0?n:J(n)?n.map(He):S({},n)}function Ve(n,t,s,c,i,r,l,d,o){var _,p,a,u,h,k,f,w=s.props||B,g=t.props,v=t.type;if(v=="svg"?i="http://www.w3.org/2000/svg":v=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(_=0;_<r.length;_++)if((h=r[_])&&"setAttribute"in h==!!v&&(v?h.localName==v:h.nodeType==3)){n=h,r[_]=null;break}}if(n==null){if(v==null)return document.createTextNode(g);n=document.createElementNS(i,v,g.is&&g),d&&(m.__m&&m.__m(t,r),d=!1),r=null}if(v==null)w===g||d&&n.data==g||(n.data=g);else{if(r=r&&G.call(n.childNodes),!d&&r!=null)for(w={},_=0;_<n.attributes.length;_++)w[(h=n.attributes[_]).name]=h.value;for(_ in w)if(h=w[_],_!="children"){if(_=="dangerouslySetInnerHTML")a=h;else if(!(_ in g)){if(_=="value"&&"defaultValue"in g||_=="checked"&&"defaultChecked"in g)continue;V(n,_,null,h,i)}}for(_ in g)h=g[_],_=="children"?u=h:_=="dangerouslySetInnerHTML"?p=h:_=="value"?k=h:_=="checked"?f=h:d&&typeof h!="function"||w[_]===h||V(n,_,h,w[_],i);if(p)d||a&&(p.__html==a.__html||p.__html==n.innerHTML)||(n.innerHTML=p.__html),t.__k=[];else if(a&&(n.innerHTML=""),$e(t.type=="template"?n.content:n,J(u)?u:[u],t,s,c,v=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,l,r?r[0]:s.__k&&E(s,0),d,o),r!=null)for(_=r.length;_--;)ce(r[_]);d||(_="value",v=="progress"&&k==null?n.removeAttribute("value"):k!=null&&(k!==n[_]||v=="progress"&&!k||v=="option"&&k!=w[_])&&V(n,_,k,w[_],i),_="checked",f!=null&&f!=n[_]&&V(n,_,f,w[_],i))}return n}function le(n,t,s){try{if(typeof n=="function"){var c=typeof n.__u=="function";c&&n.__u(),c&&t==null||(n.__u=n(t))}else n.current=t}catch(i){m.__e(i,s)}}function Ee(n,t,s){var c,i;if(m.unmount&&m.unmount(n),(c=n.ref)&&(c.current&&c.current!=n.__e||le(c,null,t)),(c=n.__c)!=null){if(c.componentWillUnmount)try{c.componentWillUnmount()}catch(r){m.__e(r,t)}c.base=c.__P=null}if(c=n.__k)for(i=0;i<c.length;i++)c[i]&&Ee(c[i],t,s||typeof n.type!="function");s||ce(n.__e),n.__c=n.__=n.__e=void 0}function ze(n,t,s){return this.constructor(n,s)}function Xe(n,t,s){var c,i,r,l;t==document&&(t=document.documentElement),m.__&&m.__(n,t),i=(c=!1)?null:t.__k,r=[],l=[],ie(t,n=t.__k=Ue(A,null,[n]),i||B,B,t.namespaceURI,i?null:t.firstChild?G.call(t.childNodes):null,r,i?i.__e:t.firstChild,c,l),Fe(r,n,l)}G=Te.slice,m={__e:function(n,t,s,c){for(var i,r,l;t=t.__;)if((i=t.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(n)),l=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,c||{}),l=i.__d),l)return i.__E=i}catch(d){n=d}throw n}},Ce=0,X.prototype.setState=function(n,t){var s;s=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=S({},this.state),typeof n=="function"&&(n=n(S({},s),this.props)),n&&S(s,n),n!=null&&this.__v&&(t&&this._sb.push(t),_e(this))},X.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),_e(this))},X.prototype.render=A,$=[],xe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Le=function(n,t){return n.__v.__b-t.__v.__b},K.__r=0,Se=/(PointerCapture)$|Capture$/i,re=0,ee=ue(!1),ne=ue(!0);var je=0;function e(n,t,s,c,i,r){t||(t={});var l,d,o=t;if("ref"in o)for(d in o={},t)d=="ref"?l=t[d]:o[d]=t[d];var _={type:n,props:o,key:s,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--je,__i:-1,__u:0,__source:i,__self:r};if(typeof n=="function"&&(l=n.defaultProps))for(d in l)o[d]===void 0&&(o[d]=l[d]);return m.vnode&&m.vnode(_),_}var M,y,Y,pe,D=0,Ae=[],b=m,fe=b.__b,me=b.__r,ve=b.diffed,ge=b.__c,ye=b.unmount,ke=b.__;function oe(n,t){b.__h&&b.__h(y,n,D||t),D=0;var s=y.__H||(y.__H={__:[],__h:[]});return n>=s.__.length&&s.__.push({}),s.__[n]}function H(n){return D=1,Ke(Be,n)}function Ke(n,t,s){var c=oe(M++,2);if(c.t=n,!c.__c&&(c.__=[Be(void 0,t),function(d){var o=c.__N?c.__N[0]:c.__[0],_=c.t(o,d);o!==_&&(c.__N=[_,c.__[1]],c.__c.setState({}))}],c.__c=y,!y.__f)){var i=function(d,o,_){if(!c.__c.__H)return!0;var p=c.__c.__H.__.filter(function(u){return!!u.__c});if(p.every(function(u){return!u.__N}))return!r||r.call(this,d,o,_);var a=c.__c.props!==d;return p.forEach(function(u){if(u.__N){var h=u.__[0];u.__=u.__N,u.__N=void 0,h!==u.__[0]&&(a=!0)}}),r&&r.call(this,d,o,_)||a};y.__f=!0;var r=y.shouldComponentUpdate,l=y.componentWillUpdate;y.componentWillUpdate=function(d,o,_){if(this.__e){var p=r;r=void 0,i(d,o,_),r=p}l&&l.call(this,d,o,_)},y.shouldComponentUpdate=i}return c.__N||c.__}function Ge(n,t){var s=oe(M++,3);!b.__s&&Re(s.__H,t)&&(s.__=n,s.u=t,y.__H.__h.push(s))}function Je(n){return D=5,qe(function(){return{current:n}},[])}function qe(n,t){var s=oe(M++,7);return Re(s.__H,t)&&(s.__=n(),s.__H=t,s.__h=n),s.__}function Qe(n,t){return D=8,qe(function(){return n},t)}function Ye(){for(var n;n=Ae.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(j),n.__H.__h.forEach(se),n.__H.__h=[]}catch(t){n.__H.__h=[],b.__e(t,n.__v)}}b.__b=function(n){y=null,fe&&fe(n)},b.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),ke&&ke(n,t)},b.__r=function(n){me&&me(n),M=0;var t=(y=n.__c).__H;t&&(Y===y?(t.__h=[],y.__h=[],t.__.forEach(function(s){s.__N&&(s.__=s.__N),s.u=s.__N=void 0})):(t.__h.forEach(j),t.__h.forEach(se),t.__h=[],M=0)),Y=y},b.diffed=function(n){ve&&ve(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(Ae.push(t)!==1&&pe===b.requestAnimationFrame||((pe=b.requestAnimationFrame)||Ze)(Ye)),t.__H.__.forEach(function(s){s.u&&(s.__H=s.u),s.u=void 0})),Y=y=null},b.__c=function(n,t){t.some(function(s){try{s.__h.forEach(j),s.__h=s.__h.filter(function(c){return!c.__||se(c)})}catch(c){t.some(function(i){i.__h&&(i.__h=[])}),t=[],b.__e(c,s.__v)}}),ge&&ge(n,t)},b.unmount=function(n){ye&&ye(n);var t,s=n.__c;s&&s.__H&&(s.__H.__.forEach(function(c){try{j(c)}catch(i){t=i}}),s.__H=void 0,t&&b.__e(t,s.__v))};var be=typeof requestAnimationFrame=="function";function Ze(n){var t,s=function(){clearTimeout(c),be&&cancelAnimationFrame(t),setTimeout(n)},c=setTimeout(s,35);be&&(t=requestAnimationFrame(s))}function j(n){var t=y,s=n.__c;typeof s=="function"&&(n.__c=void 0,s()),y=t}function se(n){var t=y;n.__c=n.__(),y=t}function Re(n,t){return!n||n.length!==t.length||t.some(function(s,c){return s!==n[c]})}function Be(n,t){return typeof t=="function"?t(n):t}async function en(){const n=await fetch("/api/dumps");if(!n.ok)throw new Error(`fetch failed: ${n.status}`);return n.json()}function nn({dumps:n,filter:t,onFilter:s,onRefresh:c,error:i}){const r=n.reduce((d,o)=>d+o.tasks.length,0),l=n.reduce((d,o)=>d+o.threads.length,0);return e("div",{class:"header",children:[e("div",{class:"header-brand",children:[e("span",{class:"accent",children:"peeps"})," dashboard"]}),e("div",{class:"header-sep"}),e("div",{class:"header-stats",children:[e("span",{children:[e("span",{class:"val",children:n.length})," processes"]}),e("span",{children:[e("span",{class:"val",children:r})," tasks"]}),e("span",{children:[e("span",{class:"val",children:l})," threads"]})]}),e("div",{class:"header-spacer"}),i&&e("span",{class:"header-error",children:i}),e("input",{class:"search-box",type:"text",placeholder:"Filter...",autocomplete:"off",spellcheck:!1,value:t,onInput:d=>s(d.target.value)}),e("button",{class:"expand-trigger",style:"padding: 5px 12px; font-size: 12px",onClick:c,children:"Refresh"})]})}function L(n){return n==null?"—":n<1024?n+" B":n<1048576?(n/1024).toFixed(1)+" KB":n<1073741824?(n/1048576).toFixed(1)+" MB":(n/1073741824).toFixed(2)+" GB"}function I(n){return n>=60?(n/60).toFixed(1)+"m":n>=1?n.toFixed(2)+"s":(n*1e3).toFixed(0)+"ms"}function N(n){return n>=3600?(n/3600).toFixed(1)+"h":n>=60?(n/60).toFixed(1)+"m":n.toFixed(1)+"s"}const tn=["std::backtrace","std::sys","backtrace_rs","backtrace::","vx_dump::thread_stacks::sigprof_handler","__os_lock","_pthread_","pthread_","tokio::runtime::park","tokio::runtime::context","tokio::runtime::scheduler","tokio::runtime::runtime","tokio::runtime::blocking","core::ops::function","std::panicking","std::panic","std::rt::lang_start","<unknown>","tokio::park","mio::poll"];function sn(n){if(!n)return null;for(const t of n.split(`
`)){const s=t.trim().match(/^\d+:\s+(.+)/);if(!s)continue;const c=s[1].split(`
`)[0].trim();if(!tn.some(i=>c.startsWith(i)))return c}return null}function C(...n){return n.filter(Boolean).join(" ")}function rn(n,t){switch(n){case"tasks":return t.reduce((s,c)=>s+c.tasks.length,0);case"threads":return t.reduce((s,c)=>s+c.threads.length,0);case"locks":return t.reduce((s,c)=>{var i;return s+(((i=c.locks)==null?void 0:i.locks.length)??0)},0);case"sync":{let s=0;for(const c of t)c.sync&&(s+=c.sync.mpsc_channels.length+c.sync.oneshot_channels.length+c.sync.watch_channels.length+c.sync.once_cells.length);return s}case"requests":return t.reduce((s,c)=>{var i;return s+(((i=c.roam)==null?void 0:i.connections.reduce((r,l)=>r+l.in_flight.length,0))??0)},0);case"connections":return t.reduce((s,c)=>{var i;return s+(((i=c.roam)==null?void 0:i.connections.length)??0)},0);case"processes":return t.length;case"shm":return null}}const cn={tasks:"Tasks",threads:"Threads",locks:"Locks",sync:"Sync",requests:"Requests",connections:"Connections",processes:"Processes",shm:"SHM"};function ln({tabs:n,active:t,onSelect:s,dumps:c}){return e("div",{class:"tab-bar",children:n.map(i=>{const r=rn(i,c);return e("div",{class:C("tab",i===t&&"active"),onClick:()=>s(i),children:[cn[i],r!=null&&e("span",{class:"tab-badge",children:r})]},i)})})}function U({label:n="trace",content:t}){const[s,c]=H(!1);return t?e(A,{children:[e("span",{class:"expand-trigger",onClick:()=>c(!s),children:n}),s&&e("div",{class:"expandable-content open",children:t})]}):e("span",{class:"muted",children:"—"})}function Me(n){switch(n){case"Polling":return"state-polling";case"Completed":return"state-completed";default:return"state-pending"}}function on(n){if(n.state==="Polling"){const t=n.poll_events[n.poll_events.length-1];if((t==null?void 0:t.duration_secs)!=null&&t.duration_secs>1)return"severity-danger";if((t==null?void 0:t.duration_secs)!=null&&t.duration_secs>.1)return"severity-warn"}return""}function an(n,t){var c;if(!t)return!0;const s=t.toLowerCase();return n.name.toLowerCase().includes(s)||n.process.toLowerCase().includes(s)||n.state.toLowerCase().includes(s)||(((c=n.parent_task_name)==null?void 0:c.toLowerCase().includes(s))??!1)||String(n.id).includes(s)}function dn({dumps:n,filter:t}){const[s,c]=H("table"),i=[];for(const l of n)for(const d of l.tasks)i.push({...d,process:l.process_name,pid:l.pid});const r=i.filter(l=>an(l,t));return i.length===0?e("div",{class:"empty-state fade-in",children:[e("div",{class:"icon",children:"T"}),e("p",{children:"No tasks tracked"}),e("p",{class:"sub",children:"Tasks appear when using peeps::tasks::spawn_tracked()"})]}):e("div",{class:"fade-in",children:[e("div",{style:"margin-bottom: 12px; display: flex; gap: 8px",children:[e("button",{class:C("expand-trigger",s==="table"&&"active"),style:"padding: 4px 10px",onClick:()=>c("table"),children:"Table"}),e("button",{class:C("expand-trigger",s==="tree"&&"active"),style:"padding: 4px 10px",onClick:()=>c("tree"),children:"Tree"})]}),s==="table"?e(_n,{tasks:r}):e(hn,{tasks:r})]})}function _n({tasks:n}){return e("div",{class:"card",children:e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"ID"}),e("th",{children:"Process"}),e("th",{children:"Name"}),e("th",{children:"State"}),e("th",{children:"Age"}),e("th",{children:"Parent"}),e("th",{children:"Polls"}),e("th",{children:"Last Poll"}),e("th",{children:"Backtrace"})]})}),e("tbody",{children:n.map(t=>e("tr",{class:on(t),children:[e("td",{class:"mono",children:["#",t.id]}),e("td",{class:"mono",children:t.process}),e("td",{class:"mono",children:t.name}),e("td",{children:e("span",{class:C("state-badge",Me(t.state)),children:t.state})}),e("td",{class:"num",children:N(t.age_secs)}),e("td",{class:"mono",children:t.parent_task_id!=null?e("span",{children:[t.parent_task_name??""," (#",t.parent_task_id,")"]}):e("span",{class:"muted",children:"—"})}),e("td",{class:"num",children:t.poll_events.length}),e("td",{class:"num",children:t.poll_events.length>0?I(t.poll_events[t.poll_events.length-1].duration_secs??0):"—"}),e("td",{children:e(U,{content:t.spawn_backtrace||null})})]},`${t.pid}-${t.id}`))})]})})}function hn({tasks:n}){const t=new Map;for(const i of n)t.set(i.id,i);const s=n.filter(i=>i.parent_task_id==null||!t.has(i.parent_task_id)),c=new Map;for(const i of n)if(i.parent_task_id!=null&&t.has(i.parent_task_id)){const r=c.get(i.parent_task_id)??[];r.push(i),c.set(i.parent_task_id,r)}return e("div",{children:s.map(i=>e(De,{task:i,children:c,depth:0},i.id))})}function De({task:n,children:t,depth:s}){const c=t.get(n.id)??[];return e("div",{class:s===0?"tree-node-root":"tree-node",children:[e("div",{class:"tree-item",children:[e("span",{class:C("state-badge",Me(n.state)),style:"margin-right: 6px",children:n.state}),e("span",{class:"mono",children:["#",n.id," ",n.name]}),e("span",{class:"muted",style:"margin-left: 8px",children:[n.process," · ",N(n.age_secs)]})]}),c.map(i=>e(De,{task:i,children:t,depth:s+1},i.id))]})}function un(n){return n.same_location_count>=10?"severity-danger":n.same_location_count>=5?"severity-warn":""}function pn({dumps:n,filter:t}){const s=[];for(const r of n)for(const l of r.threads)s.push({...l,process:r.process_name});const c=t.toLowerCase(),i=s.filter(r=>{var l;return!c||r.name.toLowerCase().includes(c)||r.process.toLowerCase().includes(c)||(((l=r.dominant_frame)==null?void 0:l.toLowerCase().includes(c))??!1)});return s.length===0?e("div",{class:"empty-state fade-in",children:[e("div",{class:"icon",children:"T"}),e("p",{children:"No thread data"})]}):e("div",{class:"card fade-in",children:e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Process"}),e("th",{children:"Thread"}),e("th",{children:"Samples"}),e("th",{children:"Responded"}),e("th",{children:"Stuck"}),e("th",{children:"Top Frame"}),e("th",{children:"Backtrace"})]})}),e("tbody",{children:i.map((r,l)=>e("tr",{class:un(r),children:[e("td",{class:"mono",children:r.process}),e("td",{class:"mono",children:r.name}),e("td",{class:"num",children:r.samples}),e("td",{class:"num",children:r.responded}),e("td",{class:C("num",r.same_location_count>=5&&"text-red"),children:r.same_location_count}),e("td",{class:"mono",style:"max-width:400px;overflow:hidden;text-overflow:ellipsis",children:r.dominant_frame??sn(r.backtrace)??e("span",{class:"muted",children:"—"})}),e("td",{children:e(U,{content:r.backtrace})})]},l))})]})})}function fn({dumps:n,filter:t}){const s=[];for(const r of n)if(r.locks)for(const l of r.locks.locks)s.push({...l,process:r.process_name});const c=t.toLowerCase(),i=s.filter(r=>!c||r.name.toLowerCase().includes(c)||r.process.toLowerCase().includes(c));return s.length===0?e("div",{class:"empty-state fade-in",children:[e("div",{class:"icon",children:"L"}),e("p",{children:"No contended locks"})]}):e("div",{class:"fade-in",children:i.map((r,l)=>e("div",{class:"card",children:[e("div",{class:"card-head",children:[e("span",{class:"mono",children:r.process}),e("span",{class:"muted",children:"/"}),e("span",{class:"mono",children:r.name}),e("span",{class:"muted",style:"margin-left: auto",children:[r.acquires," acquires, ",r.releases," releases"]})]}),r.holders.length>0&&e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Holder"}),e("th",{children:"Kind"}),e("th",{children:"Held"}),e("th",{children:"Task"}),e("th",{children:"Backtrace"})]})}),e("tbody",{children:r.holders.map((d,o)=>e("tr",{children:[e("td",{class:"mono",children:["holder #",o]}),e("td",{class:"mono",children:d.kind}),e("td",{class:"num",children:I(d.held_secs)}),e("td",{class:"mono",children:d.task_id!=null?e("span",{children:[d.task_name??""," (#",d.task_id,")"]}):e("span",{class:"muted",children:"—"})}),e("td",{children:e(U,{content:d.backtrace})})]},o))})]}),r.waiters.length>0&&e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Waiter"}),e("th",{children:"Kind"}),e("th",{children:"Waiting"}),e("th",{children:"Task"}),e("th",{children:"Backtrace"})]})}),e("tbody",{children:r.waiters.map((d,o)=>e("tr",{class:d.waiting_secs>1?"severity-warn":"",children:[e("td",{class:"mono",children:["waiter #",o]}),e("td",{class:"mono",children:d.kind}),e("td",{class:"num",children:I(d.waiting_secs)}),e("td",{class:"mono",children:d.task_id!=null?e("span",{children:[d.task_name??""," (#",d.task_id,")"]}):e("span",{class:"muted",children:"—"})}),e("td",{children:e(U,{content:d.backtrace})})]},o))})]})]},l))})}function we(n){switch(n){case"Pending":return"state-pending";case"Sent":case"Received":case"Initialized":return"state-completed";case"Initializing":return"state-initializing";case"SenderDropped":case"ReceiverDropped":return"state-dropped";case"Empty":return"state-empty";default:return""}}function Z(n,t){return n==null?e("span",{class:"muted",children:"—"}):e("span",{class:"mono",children:[t??""," (#",n,")"]})}function mn({dumps:n,filter:t}){const s=t.toLowerCase(),c=[],i=[],r=[],l=[];for(const o of n)if(o.sync){for(const _ of o.sync.mpsc_channels)c.push({process:o.process_name,ch:_});for(const _ of o.sync.oneshot_channels)i.push({process:o.process_name,ch:_});for(const _ of o.sync.watch_channels)r.push({process:o.process_name,ch:_});for(const _ of o.sync.once_cells)l.push({process:o.process_name,ch:_})}const d=(o,_)=>!s||o.toLowerCase().includes(s)||_.toLowerCase().includes(s);return e("div",{class:"fade-in",children:[c.length>0&&e("div",{class:"card",style:"margin-bottom: 16px",children:[e("div",{class:"card-head",children:"MPSC Channels"}),e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Process"}),e("th",{children:"Name"}),e("th",{children:"Type"}),e("th",{children:"Sent"}),e("th",{children:"Recv"}),e("th",{children:"Senders"}),e("th",{children:"Waiters"}),e("th",{children:"Age"}),e("th",{children:"Creator"})]})}),e("tbody",{children:c.filter(o=>d(o.process,o.ch.name)).map((o,_)=>e("tr",{class:C(o.ch.send_waiters>0&&"severity-warn",(o.ch.sender_closed||o.ch.receiver_closed)&&"severity-danger"),children:[e("td",{class:"mono",children:o.process}),e("td",{class:"mono",children:o.ch.name}),e("td",{class:"mono",children:o.ch.bounded?`bounded(${o.ch.capacity})`:"unbounded"}),e("td",{class:"num",children:o.ch.sent}),e("td",{class:"num",children:o.ch.received}),e("td",{class:"num",children:o.ch.sender_count}),e("td",{class:C("num",o.ch.send_waiters>0&&"text-amber"),children:o.ch.send_waiters}),e("td",{class:"num",children:N(o.ch.age_secs)}),e("td",{children:Z(o.ch.creator_task_id,o.ch.creator_task_name)})]},_))})]})]}),i.length>0&&e("div",{class:"card",style:"margin-bottom: 16px",children:[e("div",{class:"card-head",children:"Oneshot Channels"}),e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Process"}),e("th",{children:"Name"}),e("th",{children:"State"}),e("th",{children:"Age"}),e("th",{children:"Creator"})]})}),e("tbody",{children:i.filter(o=>d(o.process,o.ch.name)).map((o,_)=>e("tr",{children:[e("td",{class:"mono",children:o.process}),e("td",{class:"mono",children:o.ch.name}),e("td",{children:e("span",{class:C("state-badge",we(o.ch.state)),children:o.ch.state})}),e("td",{class:"num",children:N(o.ch.age_secs)}),e("td",{children:Z(o.ch.creator_task_id,o.ch.creator_task_name)})]},_))})]})]}),r.length>0&&e("div",{class:"card",style:"margin-bottom: 16px",children:[e("div",{class:"card-head",children:"Watch Channels"}),e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Process"}),e("th",{children:"Name"}),e("th",{children:"Changes"}),e("th",{children:"Receivers"}),e("th",{children:"Age"}),e("th",{children:"Creator"})]})}),e("tbody",{children:r.filter(o=>d(o.process,o.ch.name)).map((o,_)=>e("tr",{children:[e("td",{class:"mono",children:o.process}),e("td",{class:"mono",children:o.ch.name}),e("td",{class:"num",children:o.ch.changes}),e("td",{class:"num",children:o.ch.receiver_count}),e("td",{class:"num",children:N(o.ch.age_secs)}),e("td",{children:Z(o.ch.creator_task_id,o.ch.creator_task_name)})]},_))})]})]}),l.length>0&&e("div",{class:"card",children:[e("div",{class:"card-head",children:"OnceCells"}),e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Process"}),e("th",{children:"Name"}),e("th",{children:"State"}),e("th",{children:"Age"}),e("th",{children:"Init Duration"})]})}),e("tbody",{children:l.filter(o=>d(o.process,o.ch.name)).map((o,_)=>e("tr",{children:[e("td",{class:"mono",children:o.process}),e("td",{class:"mono",children:o.ch.name}),e("td",{children:e("span",{class:C("state-badge",we(o.ch.state)),children:o.ch.state})}),e("td",{class:"num",children:N(o.ch.age_secs)}),e("td",{class:"num",children:o.ch.init_duration_secs!=null?(o.ch.init_duration_secs*1e3).toFixed(0)+"ms":"—"})]},_))})]})]})]})}function vn({dumps:n,filter:t}){const s=t.toLowerCase(),c=n.filter(i=>!s||i.process_name.toLowerCase().includes(s));return n.length===0?e("div",{class:"empty-state fade-in",children:[e("div",{class:"icon",children:"P"}),e("p",{children:"No processes"}),e("p",{class:"sub",children:"Waiting for instrumented processes to connect..."})]}):e("div",{class:"card-grid fade-in",children:c.map(i=>e(gn,{dump:i},`${i.process_name}-${i.pid}`))})}function gn({dump:n}){var l,d,o,_,p;const t=((l=n.roam)==null?void 0:l.connections.length)??0,s=((d=n.roam)==null?void 0:d.connections.reduce((a,u)=>a+u.in_flight.length,0))??0,c=((o=n.roam)==null?void 0:o.connections.reduce((a,u)=>a+u.total_completed,0))??0,i=((_=n.roam)==null?void 0:_.connections.reduce((a,u)=>a+u.transport.bytes_sent,0))??0,r=((p=n.roam)==null?void 0:p.connections.reduce((a,u)=>a+u.transport.bytes_received,0))??0;return e("div",{class:"proc-card",children:[e("div",{class:"proc-card-head",children:[e("div",{class:"dot",style:"background: var(--purple)"}),e("div",{class:"name",children:n.process_name}),e("div",{class:"pid",children:["pid ",n.pid]})]}),e("div",{class:"proc-card-body",children:[e("div",{class:"proc-kv",children:[e("div",{class:"proc-kv-item",children:[e("span",{class:"k",children:"Tasks"}),e("span",{class:"v",children:n.tasks.length})]}),e("div",{class:"proc-kv-item",children:[e("span",{class:"k",children:"Threads"}),e("span",{class:"v",children:n.threads.length})]}),t>0&&e(A,{children:[e("div",{class:"proc-kv-item",children:[e("span",{class:"k",children:"Connections"}),e("span",{class:"v",children:t})]}),e("div",{class:"proc-kv-item",children:[e("span",{class:"k",children:"In-flight"}),e("span",{class:"v",children:s})]}),e("div",{class:"proc-kv-item",children:[e("span",{class:"k",children:"Completed"}),e("span",{class:"v",children:c})]}),e("div",{class:"proc-kv-item",children:[e("span",{class:"k",children:"TX / RX"}),e("span",{class:"v",children:[L(i)," / ",L(r)]})]})]}),n.locks&&e("div",{class:"proc-kv-item",children:[e("span",{class:"k",children:"Contended locks"}),e("span",{class:"v",children:n.locks.locks.length})]})]}),e("div",{class:"proc-section",style:"font-size: 11px; color: var(--fg-muted)",children:["Timestamp: ",n.timestamp]})]})]})}function yn({dumps:n,filter:t}){const s=[];for(const r of n)if(r.roam)for(const l of r.roam.connections)s.push({...l,process:r.process_name});const c=t.toLowerCase(),i=s.filter(r=>{var l;return!c||r.process.toLowerCase().includes(c)||r.name.toLowerCase().includes(c)||(((l=r.peer_name)==null?void 0:l.toLowerCase().includes(c))??!1)});return s.length===0?e("div",{class:"empty-state fade-in",children:[e("div",{class:"icon",children:"C"}),e("p",{children:"No connections"})]}):e("div",{class:"card fade-in",children:e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Process"}),e("th",{children:"Name"}),e("th",{children:"Peer"}),e("th",{children:"Age"}),e("th",{children:"In-Flight"}),e("th",{children:"Completed"}),e("th",{children:"Channels"}),e("th",{children:"TX"}),e("th",{children:"RX"}),e("th",{children:"Last Activity"})]})}),e("tbody",{children:i.map((r,l)=>e("tr",{children:[e("td",{class:"mono",children:r.process}),e("td",{class:"mono",children:r.name}),e("td",{class:"mono",children:r.peer_name??e("span",{class:"muted",children:"?"})}),e("td",{class:"num",children:N(r.age_secs)}),e("td",{class:"num",children:r.in_flight.length}),e("td",{class:"num",children:r.total_completed}),e("td",{class:"num",children:r.channels.length}),e("td",{class:"num",children:[L(r.transport.bytes_sent),e("span",{class:"muted",children:[" (",r.transport.frames_sent,"f)"]})]}),e("td",{class:"num",children:[L(r.transport.bytes_received),e("span",{class:"muted",children:[" (",r.transport.frames_received,"f)"]})]}),e("td",{class:"num",children:r.transport.last_recv_ago_secs!=null?I(r.transport.last_recv_ago_secs)+" ago":"—"})]},l))})]})})}function kn(n){return n.elapsed_secs>10?"severity-danger":n.elapsed_secs>2?"severity-warn":""}function bn({dumps:n,filter:t}){const s=[];for(const r of n)if(r.roam)for(const l of r.roam.connections)for(const d of l.in_flight)s.push({...d,process:r.process_name,connection:l.name,peer:l.peer_name??"?"});s.sort((r,l)=>l.elapsed_secs-r.elapsed_secs);const c=t.toLowerCase(),i=s.filter(r=>{var l;return!c||r.process.toLowerCase().includes(c)||(((l=r.method_name)==null?void 0:l.toLowerCase().includes(c))??!1)||r.connection.toLowerCase().includes(c)||r.peer.toLowerCase().includes(c)});return s.length===0?e("div",{class:"empty-state fade-in",children:[e("div",{class:"icon",children:"R"}),e("p",{children:"No in-flight requests"})]}):e("div",{class:"card fade-in",children:e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Dir"}),e("th",{children:"Process"}),e("th",{children:"Method"}),e("th",{children:"Elapsed"}),e("th",{children:"Connection"}),e("th",{children:"Peer"}),e("th",{children:"Request ID"}),e("th",{children:"Backtrace"})]})}),e("tbody",{children:i.map((r,l)=>e("tr",{class:kn(r),children:[e("td",{children:e("span",{class:C("dir",r.direction==="Outgoing"?"dir-out":"dir-in"),children:r.direction==="Outgoing"?"→":"←"})}),e("td",{class:"mono",children:r.process}),e("td",{class:"mono",children:r.method_name??`method_${r.method_id}`}),e("td",{class:"num",children:I(r.elapsed_secs)}),e("td",{class:"mono",children:r.connection}),e("td",{class:"mono",children:r.peer}),e("td",{class:"num",children:r.request_id}),e("td",{children:e(U,{content:r.backtrace})})]},l))})]})})}function wn({dumps:n,filter:t}){const s=t.toLowerCase(),c=[];for(const r of n)if(r.shm)for(const l of r.shm.segments)c.push({process:r.process_name,seg:l});const i=c.filter(r=>{var l;return!s||r.process.toLowerCase().includes(s)||(((l=r.seg.segment_path)==null?void 0:l.toLowerCase().includes(s))??!1)});return c.length===0?e("div",{class:"empty-state fade-in",children:[e("div",{class:"icon",children:"S"}),e("p",{children:"No SHM segments"})]}):e("div",{class:"fade-in",children:i.map((r,l)=>e("div",{class:"card",style:"margin-bottom: 16px",children:[e("div",{class:"card-head",children:[e("span",{class:"mono",children:r.process}),e("span",{class:"muted",children:"/"}),e("span",{class:"mono",children:r.seg.segment_path??"anonymous"}),e("span",{class:"muted",style:"margin-left: auto",children:[L(r.seg.current_size)," / ",L(r.seg.total_size)]})]}),e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:"Peer"}),e("th",{children:"Name"}),e("th",{children:"State"}),e("th",{children:"Buf Cap"}),e("th",{children:"TX"}),e("th",{children:"RX"}),e("th",{children:"Calls TX"}),e("th",{children:"Calls RX"}),e("th",{children:"Heartbeat"})]})}),e("tbody",{children:r.seg.peers.map(d=>e("tr",{children:[e("td",{class:"num",children:d.peer_id}),e("td",{class:"mono",children:d.name??e("span",{class:"muted",children:"—"})}),e("td",{class:"mono",children:d.state}),e("td",{class:"num",children:L(d.bipbuf_capacity)}),e("td",{class:"num",children:L(d.bytes_sent)}),e("td",{class:"num",children:L(d.bytes_received)}),e("td",{class:"num",children:d.calls_sent}),e("td",{class:"num",children:d.calls_received}),e("td",{class:"num",children:d.time_since_heartbeat_ms!=null?d.time_since_heartbeat_ms+"ms":"—"})]},d.peer_id))})]})]},l))})}const Cn=["tasks","threads","locks","sync","requests","connections","processes","shm"];function xn(){const[n,t]=H([]),[s,c]=H("tasks"),[i,r]=H(""),[l,d]=H(null),o=Je(null),_=Qe(async()=>{try{const f=await en();t(f),d(null)}catch(f){d(String(f))}},[]);Ge(()=>(_(),o.current=setInterval(_,2e3),()=>{o.current&&clearInterval(o.current)}),[_]);const p=n.some(f=>f.sync!=null),a=n.some(f=>f.roam!=null),u=n.some(f=>f.shm!=null),h=n.some(f=>f.locks!=null),k=Cn.filter(f=>!(f==="sync"&&!p||f==="requests"&&!a||f==="connections"&&!a||f==="shm"&&!u||f==="locks"&&!h));return e("div",{class:"app",children:[e(nn,{dumps:n,filter:i,onFilter:r,onRefresh:_,error:l}),e(ln,{tabs:k,active:s,onSelect:c,dumps:n}),e("div",{class:"content",children:[s==="tasks"&&e(dn,{dumps:n,filter:i}),s==="threads"&&e(pn,{dumps:n,filter:i}),s==="locks"&&e(fn,{dumps:n,filter:i}),s==="sync"&&e(mn,{dumps:n,filter:i}),s==="requests"&&e(bn,{dumps:n,filter:i}),s==="connections"&&e(yn,{dumps:n,filter:i}),s==="processes"&&e(vn,{dumps:n,filter:i}),s==="shm"&&e(wn,{dumps:n,filter:i})]})]})}Xe(e(xn,{}),document.getElementById("app"));
